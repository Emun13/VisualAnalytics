<!DOCTYPE html>
<html>
<head>
<title>Visual Analytics System</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="./data.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<script src="./pie.js"></script>

<style>
  body {
    background-color: #000;
    font-family: Verdana, sans-serif;
    color: #fff;
  }
  .flexbox {
    display: flex;
    width: 100%;
    position: relative;
    top: -30px;
  }
  .flexCol1 {
    position: relative;
    text-align: center;
    width: 43%;
    left: .5%;
    padding-left: 1%;
    color: #fff;
  }
  .flexCol2 {
    position: relative;
    text-align: center;
    /*width: 50%;*/
    color: #fff;
  }
  .map {
    width: 100%;
  }
  .grid {
    width: 131.5%;
    height: 70%;
    padding-left: 5%;
    position: relative;
    top: -7%;
  }
  .key {
    position: absolute;
    background-color: #f3f3f3;
    color: #000;
    font-weight: bold;
    text-align: right;
    bottom: 0%;
    left: -2%;
    width: 24%;
    height: 32.5%;
    bottom: 1%;
    border-radius: 7%;
    font-size: .93vw;
  }
  .rectkey {
    position: absolute;
    left: 0%;
    width: 8%;
    height: 4%;
    bottom: 27%;
    color: #fff;
    font-size: 1vw;
  }
  .mapMarker {
    position: absolute;
    left: 29%;
    width: 7%;
    height: 3%;
    bottom: 90%;
    color: #fff;
    font-size: 1vw;
    font-weight: bold;
    color: #000
  }
  .roadrunner {
    position: absolute;
    left: 32%;
    bottom: 17%;
    font-size: 1vw;
  }
  .kasios {
    position: absolute;
    left: 39%;
    bottom: 13%;
    font-size: 1vw;
  }
  .radiance {
    position: absolute;
    left: 50%;
    bottom: 4%;
    font-size: 1vw;
  }
  .indigo {
    position: absolute;
    left: 59%;
    bottom: 6%;
    font-size: 1vw;
  }
  .triangle {
    position: absolute;
    bottom: 17.5%;
    left: 47.5%;
    color: #0069ff;
  }
  .square {
    position: absolute;
    background-color: rgba(255,0,106,.9);
    bottom: 17.5%;
    left: 47.5%;
    padding-left: .4%;
    padding-right: .4%;
    font-size: 1vw;
    color: #fff
  }
  /* Slider Stuff */
  .switch {
    position: absolute;
    display: inline-block;
    width: 13%;
    height: 6.5%;
    left: 83%; 
    top: 10.5%;
  }
  .switch input { 
    opacity: 0;
    width: 0;
    height: 0;
  }
  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #c94947;
    transition: .4s;
  }
  .slider:before {
    position: absolute;
    content: "";
    height: 76%;
    width: 45%;
    left: 6%;
    bottom: 12%;
    background-color: #fff;
    transition: .4s;
  }
  input:checked + .slider {
    background-color: #47c949;
  }
  input:checked + .slider:before {
    transform: translateX(92%);
  }
  .scroll {
    position: absolute;
    left: 85%; 
    top: 85%;
    width: 43%;
    height: 8%;
    font-size: 2vw;
    border-radius: 15px;
    background-color: #51b7ff;
    border: 3px solid #fff; /* Green */
    text-align: center;
    opacity: 1;
    transition: 0.3s;
    cursor: pointer;
    color: #fff;
    outline:none;
  }
  .scroll:hover {
    background-color: #518cff;
  }
  .squareGrid {
    position: absolute;
    background-color: rgba(0,0,0,1);
    bottom: 17.5%;
    left: 47.5%;
    padding-left: .6%;
    padding-right: .6%;
    font-size: 1vw;
    color: #fff;
  }
  .squareGrid:hover + .hide {
    display: block;
    font-size: 1vw;
  }
  .triangleGrid {
    position: absolute;
    bottom: 17.5%;
    left: 47.5%;
    color: #0069ff;
  }
  .triangleGrid:hover + .hide {
    display: block;
    font-size: 1vw;
  }
  .hide {
    position: absolute;
    display: none;
  }
  .rectangle{
    fill: orange;
    position: absolute;
    stroke: blue;
    right: 30%;
  }

.button {
  border: none;
  color: white;
  padding: 5px 30px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 1vw;
  margin: 2px 0px;
  transition-duration: 0.4s;
  cursor: pointer;
  border-radius: 10px;
}

.button2 {
  background-color: white; 
  color: black; 
  border: 2px solid #007ee6;
}

.button2:hover {
  background-color: #007ee6;
  color: white;
}

.dropdown-check-list {
  display: inline-block;
  border: none;
  width: 92%; 
  position: relative;
  left: 4.5%;
  top: -8px;
  font-size: 1vw;
}

.pie-dropdown {
  display: inline-block;
  border: none;
  width: 80%; 
  position: relative;
  left: 6%;
  top: -8px;
  font-size: 1vw;
  background-color: #007ee6;
  padding: 4.5px 10px 4.5px 4.5px;
  border-radius: 3px;
  color: #fff;
  border: none;
}

.pie-dropdown:hover {
  background-color: rgba(0,126,230, .7);
}

.bargraph-dropdown {
  display: inline-block;
  border: none;
  width: 80%; 
  position: relative;
  left: 6%;
  top: -8px;
  font-size: 1vw;
  background-color: #007ee6;
  padding: 4.5px 10px 4.5px 4.5px;
  border-radius: 3px;
  color: #fff;
  border: none;
}

/*.chem-select .bargraph-dropdown:hover {
  background-color: rgba(0,126,230, .7);
}*/

/*.chem-select:hover {
  background-color: rgba(0,126,230, .7);
}*/
#chemical-select:hover + #barDropdown {
    background-color: rgba(0,126,230, .7);
}

.dropdown-check-list .anchor {
  position: relative;
  cursor: pointer;
  display: inline-block;
  background-color: #007ee6;
  padding: 5px 30px 5px 5px;
  border-radius: 3px;
  color: #fff;
  border: none;
  /*border: 1px solid #ccc;*/
}
.dropdown-check-list .anchor:hover {
  background-color: rgba(0,126,230, .7);
}

.dropdown-check-list .anchor:after {
  position: absolute;
  content: "";
  border-left: 2px solid #fff;
  border-top: 2px solid #fff;
  padding: 5px;
  right: 10px;
  top: 20%;
  transform: rotate(-135deg);
}

.dropdown-check-list .anchor:active:after {
  right: 8px;
  top: 21%;
}

.dropdown-check-list ul.items {
  /*padding: 2px;*/
  display: none;
  margin: 0;
  width: 93%;
  margin-top: -2px;
  
  padding-right: 8px;
  padding-left: 1px;
  padding-bottom: 10px;

  /*margin-right: 20px;*/
  padding-top: 10px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.4);
  border-top: none;
  background-color: rgba(255,255,255,1);
  position: absolute; 
  z-index: 10;
}

.dropdown-check-list ul.items li {
  list-style: none;
}

/*.dropdown-check-list.visible .anchor {*/
  /*color: #0094ff;*/
/*}*/

.dropdown-check-list.visible .items {
  display: block;
}

.container {
  width: 95%;
  position: relative;
  left: 20px;
  top: -10px;
  /*margin: 70px auto;*/
}
.slider-container {
  width: 100%;
  position: relative;
  left: 1%;
}

</style>
<link rel="stylesheet" href="css/rSlider.min.css">
</head>

<body>
  <h1 style="position: relative; bottom: 15px; text-align: center; font-size: 40px; position: relative;">Vast Challenge 2017: Mini Challenge 2</h1>
  <h3 style="text-align: center; position: relative; bottom: 30px">By: Michelle Roitgarts, Janny Huang, & Mohammed Emun</h3>

  <div class="flexbox">
    <div class="flexCol1" style="left: 2%; color: #00e9ff;">
      <img class="map" src="Map.jpg" alt="Map of Sanctuary">
      <div>
        <span class="mapMarker" id="Entrance0" style="background-color: #acdb80;">0</span>
        <span class="mapMarker" id="Entrance1" style="background-color: #acdb80; bottom: 65%; left: 9%">1</span>
        <span class="mapMarker" id="Entrance2" style="background-color: #acdb80; bottom: 56.5%; left: 83.5%">2</span>
        <span class="mapMarker" id="Entrance3" style="background-color: #acdb80; bottom: 20.5%; left: 59.5%">3</span>
        <span class="mapMarker" id="Entrance4" style="background-color: #acdb80; bottom: 11.3%; left: 64.5%">4</span>

        <span class="mapMarker" id="GeneralGate0" style="background-color: #98e4d0; left: 50%; bottom: 91.5%">0</span>
        <span class="mapMarker" id="GeneralGate3" style="background-color: #98e4d0; left: 83.5%; bottom: 70.5%">0</span>
        <span class="mapMarker" id="GeneralGate1" style="background-color: #98e4d0; left: 28%; bottom: 84.5%">1</span>
        <span class="mapMarker" id="GeneralGate2" style="background-color: #98e4d0; left: 48%; bottom: 81.5%">2</span>
        <span class="mapMarker" id="GeneralGate4" style="background-color: #98e4d0; left: 31%; bottom: 51.2%">4</span>
        <span class="mapMarker" id="GeneralGate5" style="background-color: #98e4d0; left: 56%; bottom: 45.5%">5</span>
        <span class="mapMarker" id="GeneralGate6" style="background-color: #98e4d0; left: 61%; bottom: 34%">6</span>
        <span class="mapMarker" id="GeneralGate7" style="background-color: #98e4d0; left: 30%; bottom: 30.5%">7</span>

        <span class="mapMarker" id="RangerStop0" style="background-color: #ffff9b; left: 40%; bottom: 88.5%">0</span>
        <span class="mapMarker" id="RangerStop1" style="background-color: #ffff9b; left: 9%; bottom: 85%">1</span>
        <span class="mapMarker" id="RangerStop2" style="background-color: #ffff9b; left: 38%; bottom: 80%">2</span>
        <span class="mapMarker" id="RangerStop3" style="background-color: #ffff9b; left: 67%; bottom: 75.5%">3</span>
        <span class="mapMarker" id="RangerStop4" style="background-color: #ffff9b; left: 9%; bottom: 52.5%">4</span>
        <span class="mapMarker" id="RangerStop5" style="background-color: #ffff9b; left: 68%; bottom: 42.5%">5</span>
        <span class="mapMarker" id="RangerStop6" style="background-color: #ffff9b; left: 55%; bottom: 29.5%">6</span>

        <span class="mapMarker" id="Camping0" style="background-color: #ffcb71; left: 24%; bottom: 78%">0</span>
        <span class="mapMarker" id="Camping1" style="background-color: #ffcb71; left: 59.5%; bottom: 73%">1</span>
        <span class="mapMarker" id="Camping2" style="background-color: #ffcb71; left: 21.8%; bottom: 67.5%">2</span>
        <span class="mapMarker" id="Camping3" style="background-color: #ffcb71; left: 21.8%; bottom: 64%">3</span>
        <span class="mapMarker" id="Camping4" style="background-color: #ffcb71; left: 23%; bottom: 55.4%">4</span>
        <span class="mapMarker" id="Camping5" style="background-color: #ffcb71; left: 11%; bottom: 41%">5</span>
        <span class="mapMarker" id="Camping6" style="background-color: #ffcb71; left: 68.5%; bottom: 16.5%">6</span>
        <span class="mapMarker" id="Camping7" style="background-color: #ffcb71; left: 82.5%; bottom: 30%">7</span>
        <span class="mapMarker" id="Camping8" style="background-color: #ffcb71; left: 83.5%; bottom: 74%">8</span>

        <span class="mapMarker" id="Gate0" style="background-color: #fe7d6e; left: 30%; bottom: 81%">0</span>
        <span class="mapMarker" id="Gate1" style="background-color: #fe7d6e; left: 30%; bottom: 76%">1</span>
        <span class="mapMarker" id="Gate2" style="background-color: #fe7d6e; left: 14.5%; bottom: 71%">2</span>
        <span class="mapMarker" id="Gate3" style="background-color: #fe7d6e; left: 69.5%; bottom: 68%">3</span>
        <span class="mapMarker" id="Gate4" style="background-color: #fe7d6e; left: 75.5%; bottom: 44%">4</span>
        <span class="mapMarker" id="Gate5" style="background-color: #fe7d6e; left: 62.5%; bottom: 29%">5</span>
        <span class="mapMarker" id="Gate6" style="background-color: #fe7d6e; left: 54.5%; bottom: 26.5%">6</span>
        <span class="mapMarker" id="Gate7" style="background-color: #fe7d6e; left: 50.5%; bottom: 22.5%">7</span>
        <span class="mapMarker" id="Gate8" style="background-color: #fe7d6e; left: 65.3%; bottom: 14.2%">8</span>

      </div>

      <span class="key">
        <p style="padding-top: 4%; padding-right: 12%">Entrance</p>
        <p style="padding-top: 1.5%; padding-right: 4%; font-size: .75vw">General Gate</p>
        <p style="padding-top: 4%; padding-right: 3%; font-size: .8vw">Ranger Stop</p>
        <p style="padding-top: 2.5%; padding-right: 12%">Camping</p>
        <p style="padding-top: 0.1%; padding-right: 32%">Gate</p>
        <p style="padding-top: 0%; padding-right: 21%">Sensor</p>
      </span>
      <span class="rectkey" style="background-color: #acdb80;"></span>
      <span class="rectkey" style="background-color: #98e4d0; bottom: 22%"></span>
      <span class="rectkey" style="background-color: #ffff9b; bottom: 17%"></span>
      <span class="rectkey" style="background-color: #ffcb71; bottom: 12%"></span>
      <span class="rectkey" style="background-color: #fe7d6e; bottom: 7%"></span>
      <span class="rectkey" style="background-color: rgba(255,0,106,.9); bottom: 3%; left: 2.5%; width: 3%; height: 3%">N</span>

      <div class="roadrunner">Roadrunner</div>
      <span class="triangle">&#9660</span>
      <div class="kasios">Kasios</div>
      <span class="triangle" style="bottom: 14.5%; left: 48%">&#9660</span>
      <div class="radiance">Radiance</div>
      <span class="triangle" style="bottom: 17%; left: 56%">&#9660</span>
      <div class="indigo">Indigo</div>
      <span class="triangle" style="bottom: 15.2%; left: 61%">&#9660</span>

      <span class="square" id="Sensor0" style="bottom: 13%; left: 33%">1</span>
      <span class="square" id="Sensor1" style="bottom: 20%; left: 36%">2</span>
      <span class="square" id="Sensor2" style="bottom: 23.5%; left: 41%">3</span>
      <span class="square" id="Sensor3" style="bottom: 25%; left: 46%">4</span>
      <span class="square" id="Sensor4" style="bottom: 24.5%; left: 53%">5</span>
      <span class="square" id="Sensor5" style="bottom: 14.5%; left: 52%">6</span>
      <span class="square" id="Sensor6" style="bottom: 7%; left: 45%">7</span>
      <span class="square" id="Sensor7" style="bottom: 8.5%; left: 38%">8</span>
      <span class="square" id="Sensor8" style="bottom: 24%; left: 61%">9</span>
      <button type="button" id="scroll" class="scroll">Explore!</button>
    </div>

    <!-- scrolls down to grid -->
    <!-- <button type="button" id="scroll" class="scroll">Zoom In!</button> -->
 
    <div class="flexCol2" style="left: 18%;">
      <div style="position: relative; font-size: 2.5vw; top: 5%; left: -6%"><u>&nbsp Get a feel for the map! &nbsp </u></div>
      
      <div class="key" style="width: 90%; height: 75%; bottom: 6%; text-align: left;">

        <p style="position: absolute; left: 40%; top: 6%; font-size: 1.5vw;">Entrance</p>
          <label class="switch">
            <input id="Entrance_Toggle" type="checkbox" checked onclick="toggleMap('Entrance_Toggle','Entrance', 4)">
            <span class="slider"></span>
          </label>
        <p style="position: absolute; left: 40%; top: 21%; font-size: 1.5vw;">General Gate</p>
          <label class="switch" style="top: 25.5%">
            <input id="GeneralGate_Toggle" type="checkbox" checked onclick="toggleMap('GeneralGate_Toggle','GeneralGate', 7)">
            <span class="slider"></span>
          </label>
        <p style="position: absolute; left: 40%; top: 36%; font-size: 1.5vw;">Ranger Stop</p>
          <label class="switch" style="top: 40.5%">
            <input id="RangerStop_Toggle" type="checkbox" checked onclick="toggleMap('RangerStop_Toggle','RangerStop', 6)">
            <span class="slider"></span>
          </label>
        <p style="position: absolute; left: 40%; top: 51%; font-size: 1.5vw;">Camping</p>
          <label class="switch" style="top: 55.5%">
            <input id="Camping_Toggle" type="checkbox" checked onclick="toggleMap('Camping_Toggle','Camping', 8)">
            <span class="slider"></span>
          </label>
        <p style="position: absolute; left: 40%; top: 66%; font-size: 1.5vw;">Gate</p>
          <label class="switch" style="top: 70.5%">
            <input id="Gate_Toggle" type="checkbox" checked onclick="toggleMap('Gate_Toggle','Gate', 8)">
            <span class="slider"></span>
          </label>
        <p style="position: absolute; left: 40%; top: 81%; font-size: 1.5vw;">Sensor</p>
          <label class="switch" style="top: 85.5%">
            <input id="Sensor_Toggle" type="checkbox" checked onclick="toggleMap('Sensor_Toggle','Sensor', 8)">
            <span class="slider"></span>
          </label>
        <span class="rectkey" style="left: 5%; width: 30%; height: 8%; border: 1px solid #000; background-color: #acdb80; bottom: 82%"></span>
        <span class="rectkey" style="left: 5%; width: 30%; height: 8%; border: 1px solid #000; background-color: #98e4d0; bottom: 67%"></span>
        <span class="rectkey" style="left: 5%; width: 30%; height: 8%; border: 1px solid #000; background-color: #ffff9b; bottom: 52%"></span>
        <span class="rectkey" style="left: 5%; width: 30%; height: 8%; border: 1px solid #000; background-color: #ffcb71; bottom: 37%"></span>
        <span class="rectkey" style="left: 5%; width: 30%; height: 8%; border: 1px solid #000; background-color: #fe7d6e; bottom: 22%"></span>

        <span class="rectkey" style="left: 10%; width: 20%; height: 8%; border: 1px solid #000; background-color: rgba(255,0,106,.9); bottom: 7%; text-align: center;"><div style="position: relative; bottom: -25%">N</div></span>
      </div>

    </div>
  </div>
  <div style="position: relative; width: 100%; height: 50px; background-color: rgba(0,0,0,0)"></div>
  <div class="flexbox">
    <div class="flexCol1" style="left: -1%;">
      <img id="Grid1" class="grid" src="Grid.png" alt="Zoomed in Grid">
      <div style="font-size: 1.2vw;">
        <span id="Xaxis" style="position: absolute; left: -6%; width: 150%; bottom: 27%; padding-bottom: 5%; word-spacing: 1.5vw; font-size: 1vw">
          0&nbsp5 ...//... 60 65 70 75 80 85 90 95 100 105 110 115 120 125
        </span>
        <span id="Yaxis" style="text-align: center; width: 7%; height: 105%; position: absolute; left: 1.5%; bottom: -5%; padding-bottom: 5%;word-spacing: 1vw;line-height: 250%; font-size: 1vw">
          50 45 40 35 30 25 20 15 10 5
        </span>
        <!-- 70 66 -->
        <span class="triangleGrid" id="RoadrunnerGrid" style="color: #c800ff; left: 69.4%; bottom: 70.5%; font-size: 1.5vw">&#9660</span>
        <div class="hide" style="left: 60%; bottom: 75.5%">Roadrunner: (89,27)</div>
        <span class="triangleGrid" id="KasiosGrid" style="color: #ff0000; left: 70.5%; bottom: 63%; font-size: 1.5vw">&#9660</span>
        <div class="hide" style="left: 64%; bottom: 68%">Kasios: (90,21)</div>
        <span class="triangleGrid" id="RadianceGrid" style="color: #1a00ff; left: 102%; bottom: 70%; font-size: 1.5vw">&#9660</span>
        <div class="hide" style="left: 55%; bottom: 75%; width: 100%">Radiance: (109,26)</div>
        <span class="triangleGrid" id="IndigoGrid" style="color: #00a23a; left: 120.5%; bottom: 63.8%; font-size: 1.5vw">&#9660</span>
        <div class="hide" style="left: 73%; bottom: 68.8%; width: 100%">Indigo: (120,22)</div>

        <!-- Sensors -->
        <span class="squareGrid" id="S0" style="left: 31%; bottom: 63%;">1</span>
        <div class="hide" style="left: 29%; bottom: 68%">(62,21)</div>
        <div style="position: absolute; z-index: -10; left: 18.5%; bottom: 27.5%">
          <svg width="20vw" height="20vw" viewBox="-10 -10 200 200">
            <!-- center of rotation -->
            <circle cx="50" cy="50" r="3" style="fill: #fff;"/>
            <!-- non-rotated arrow -->
            <g id="TriS0C0" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS0C0" points="50 50, 40 0, 60 0" style="fill: rgb(75,192,192)">
            </g>
            <g id="TriS0C1" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS0C1" points="50 50, 40 0, 60 0" style="fill: rgb(255,206,86)">
            </g>
            <g id="TriS0C2" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS0C2" points="50 50, 40 0, 60 0" style="fill: rgb(54,162,235)">
            </g>
            <g id="TriS0C3" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS0C3" points="50 50, 40 0, 60 0" style="fill: rgb(255,99,132)">
            </g>

          </svg>
        </div>
        
        <span class="squareGrid" id="S1" style="left: 37.5%; bottom: 81%;">2</span>
        <div class="hide" style="left: 36.5%; bottom: 86%">(66,35)</div>
        <div style="position: absolute; z-index: -10; left: 25%; bottom: 46%">
          <svg width="20vw" height="20vw" viewBox="-10 -10 200 200">
            <!-- center of rotation -->
            <circle cx="50" cy="50" r="3" style="fill: #fff;"/>
            <!-- non-rotated arrow -->
            <g id="TriS1C0" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS1C0" points="50 50, 40 0, 60 0" style="fill: rgb(75,192,192)">
            </g>
            <g id="TriS1C1" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS1C1" points="50 50, 40 0, 60 0" style="fill: rgb(255,206,86)">
            </g>
            <g id="TriS1C2" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS1C2" points="50 50, 40 0, 60 0" style="fill: rgb(54,162,235)">
            </g>
            <g id="TriS1C3" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS1C3" points="50 50, 40 0, 60 0" style="fill: rgb(255,99,132)">
            </g>

          </svg>
        </div>
        
        <span class="squareGrid" id="S2" style="left: 52%; bottom: 89%;">3</span>
        <div class="hide" style="left: 50%; bottom: 94%">(76,41)</div>
        <div style="position: absolute; z-index: -10; left: 39.3%; bottom: 55%">
          <svg width="20vw" height="20vw" viewBox="-10 -15 200 200">
            <!-- center of rotation -->
            <circle cx="50" cy="50" r="3" style="fill: #fff;"/>
            <!-- non-rotated arrow -->
            <g id="TriS2C0" style="stroke: #000; display: none;" transform="rotate(0,50,50)">
              <polygon id="triFillS2C0" points="50 50, 40 0, 60 0" style="fill: rgb(75,192,192)">
            </g>
            <g id="TriS2C1" style="stroke: #000; display: none;" transform="rotate(0,50,50)">
              <polygon id="triFillS2C1" points="50 50, 40 0, 60 0" style="fill: rgb(255,206,86)">
            </g>
            <g id="TriS2C2" style="stroke: #000; display: none;" transform="rotate(0,50,50)">
              <polygon id="triFillS2C2" points="50 50, 40 0, 60 0" style="fill: rgb(54,162,235)">
            </g>
            <g id="TriS2C3" style="stroke: #000; display: none;" transform="rotate(0,50,50)">
              <polygon id="triFillS2C3" points="50 50, 40 0, 60 0" style="fill: rgb(255,99,132)">
            </g>
          </svg>
        </div>
        
        <span class="squareGrid" id="S3" style="left: 70%; bottom: 94%;">4</span>
        <div class="hide" style="left: 67%; bottom: 99%;">(88,45)</div>
        <div style="position: absolute; z-index: -10; left: 57.5%; bottom: 60%">
          <svg width="20vw" height="20vw" viewBox="-10 -15 200 200">
            <!-- center of rotation -->
            <circle cx="50" cy="50" r="3" style="fill: #fff;"/>
            <!-- non-rotated arrow -->
            <g id="TriS3C0" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS3C0" points="50 50, 40 0, 60 0" style="fill: rgb(75,192,192)">
            </g>
            <g id="TriS3C1" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS3C1" points="50 50, 40 0, 60 0" style="fill: rgb(255,206,86)">
            </g>
            <g id="TriS3C2" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS3C2" points="50 50, 40 0, 60 0" style="fill: rgb(54,162,235)">
            </g>
            <g id="TriS3C3" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS3C3" points="50 50, 40 0, 60 0" style="fill: rgb(255,99,132)">
            </g>
          </svg>
        </div>
        
        <span class="squareGrid" id="S4" style="left: 90%; bottom: 91%;">5</span>
        <div class="hide" style="left: 88%; bottom: 96%">(103,43)</div>
        <div style="position: absolute; z-index: -10; left: 79.7%; bottom: 57%">
          <svg width="20vw" height="20vw" viewBox="0 -15 200 200">
            <!-- center of rotation -->
            <circle cx="50" cy="50" r="3" style="fill: #fff;"/>
            <!-- non-rotated arrow -->
            <g id="TriS4C0" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS4C0" points="50 50, 40 0, 60 0" style="fill: rgb(75,192,192)">
            </g>
            <g id="TriS4C1" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS4C1" points="50 50, 40 0, 60 0" style="fill: rgb(255,206,86)">
            </g>
            <g id="TriS4C2" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS4C2" points="50 50, 40 0, 60 0" style="fill: rgb(54,162,235)">
            </g>
            <g id="TriS4C3" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS4C3" points="50 50, 40 0, 60 0" style="fill: rgb(255,99,132)">
            </g>
          </svg>
        </div>
        
        <span class="squareGrid" id="S5" style="left: 88%; bottom: 63.5%;">6</span>
        <div class="hide" style="left: 86%; bottom: 67.5%">(102,22)</div>
        <div style="position: absolute; z-index: -10; left: 77.7%; bottom: 29.5%">
          <svg width="20vw" height="20vw" viewBox="-1 -15 200 200">
            <!-- center of rotation -->
            <circle cx="50" cy="50" r="3" style="fill: #fff;"/>
            <!-- non-rotated arrow -->
            <g id="TriS5C0" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS5C0" points="50 50, 40 0, 60 0" style="fill: rgb(75,192,192)">
            </g>
            <g id="TriS5C1" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS5C1" points="50 50, 40 0, 60 0" style="fill: rgb(255,206,86)">
            </g>
            <g id="TriS5C2" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS5C2" points="50 50, 40 0, 60 0" style="fill: rgb(54,162,235)">
            </g>
            <g id="TriS5C3" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS5C3" points="50 50, 40 0, 60 0" style="fill: rgb(255,99,132)">
            </g>
          </svg>
        </div>
        
        <span class="squareGrid" id="S6" style="left: 70%; bottom: 41%;">7</span>
        <div class="hide" style="left: 68%; bottom: 45%">(89,3)</div>
        <div style="position: absolute; z-index: -10; left: 59.7%; bottom: 32%">
          <svg width="20vw" height="20vw" viewBox="-1 -115 200 200">
            <!-- center of rotation -->
            <circle cx="50" cy="50" r="3" style="fill: #fff;"/>
            <!-- non-rotated arrow -->
            <g id="TriS6C0" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS6C0" points="50 50, 40 0, 60 0" style="fill: rgb(75,192,192)">
            </g>
            <g id="TriS6C1" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS6C1" points="50 50, 40 0, 60 0" style="fill: rgb(255,206,86)">
            </g>
            <g id="TriS6C2" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS6C2" points="50 50, 40 0, 60 0" style="fill: rgb(54,162,235)">
            </g>
            <g id="TriS6C3" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS6C3" points="50 50, 40 0, 60 0" style="fill: rgb(255,99,132)">
            </g>
          </svg>
        </div>
        
        <span class="squareGrid" id="S7" style="left: 48%; bottom: 44%;">8</span>
        <div class="hide" style="left: 46%; bottom: 49%">(74,7)</div>
        <div style="position: absolute; z-index: -10; left: 37.7%; bottom: 28%">
          <svg width="20vw" height="20vw" viewBox="-1 -85 200 200">
            <!-- center of rotation -->
            <circle cx="50" cy="50" r="3" style="fill: #fff;"/>
            <!-- non-rotated arrow -->
            <g id="TriS7C0" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS7C0" points="50 50, 40 0, 60 0" style="fill: rgb(75,192,192)">
            </g>
            <g id="TriS7C1" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS7C1" points="50 50, 40 0, 60 0" style="fill: rgb(255,206,86)">
            </g>
            <g id="TriS7C2" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS7C2" points="50 50, 40 0, 60 0" style="fill: rgb(54,162,235)">
            </g>
            <g id="TriS7C3" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS7C3" points="50 50, 40 0, 60 0" style="fill: rgb(255,99,132)">
            </g>
          </svg>
        </div>
        
        <span class="squareGrid" id="S8" style="left: 119%; bottom: 90%;">9</span>
        <div class="hide" style="left: 117%; bottom: 95%">(119,42)</div>
        <div style="position: absolute; z-index: -10; left: 108.7%; bottom: 56%">
          <svg width="20vw" height="20vw" viewBox="-1 -15 200 200">
            <!-- center of rotation -->
            <circle cx="50" cy="50" r="3" style="fill: #fff;"/>
            <!-- non-rotated arrow -->
            <g id="TriS8C0" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS8C0" points="50 50, 40 0, 60 0" style="fill: rgb(75,192,192)">
            </g>
            <g id="TriS8C1" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS8C1" points="50 50, 40 0, 60 0" style="fill: rgb(255,206,86)">
            </g>
            <g id="TriS8C2" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS8C2" points="50 50, 40 0, 60 0" style="fill: rgb(54,162,235)">
            </g>
            <g id="TriS8C3" style="stroke: #000; display: none" transform="rotate(0,50,50)">
              <polygon id="triFillS8C3" points="50 50, 40 0, 60 0" style="fill: rgb(255,99,132)">
            </g>
          </svg>
        </div>
        <img style="position: absolute; width: 20%; left: 8%; bottom: 38%; " src="compass.png" alt="Compass">
      </div>
    </div>

    <!-- <div class="flexCol2" style="left: 18%;">
      <div style="position: relative; font-size: 4vw; top: 5%; color: black; background-color: #fff;text-align: center; width: 120%; height: 60%">
        PIE CHART
        <span style="position: absolute; left: 10%; top: 20%;">
          <svg height="284" width="300">
            <circle cx="150" cy="142" r="140" stroke="black" stroke-width="3" fill="red" />
          </svg>   
        </span>
       
      </div>
      
    </div> -->
    <div class="flexCol2" style="left:17%;">
      <canvas style="position: relative; top: -10px; width: 90%; height: 170px" id="pieChart"></canvas>
      <canvas id="BarGraph" style="position: absolute; width: 150%; height: 100px; top: 30%; height: 290px"></canvas>
    </div>
    <div class="flexCol2" style="left: 21%; top: 0%; position: relative;">
      <div style="position: relative; font-size: 1vw; top: -3%; color: black; background-color: rgba(255,255,255, 1);text-align: center; width: 105%; height: 76%; border: 3px solid #00daff; border-radius: 10px;">
        <!-- <h2><u>&nbsp Toggle All &nbsp</u></h2> -->

        <!-- <p>other stuff here</p> -->

        <h4 style="position: relative; top: -17px"><u>&nbsp Toggle Grid &nbsp</u></h4>
        <div style="display: flex; flex-direction: column; position: relative; top: -18px">

          <div id="sensorDropdown" class="dropdown-check-list" style="z-index: 10">
            <span class="anchor" style="padding-right: 42px;">Select Sensors</span>
            <ul class="items" style="text-align: left; position: absolute;">
              <li><input id="S0_checkbox" type="checkbox" style="position: relative; top: 2px">Sensor 1</li>
              <li><input id="S1_checkbox" type="checkbox" style="position: relative; top: 2px">Sensor 2</li>
              <li><input id="S2_checkbox" type="checkbox" style="position: relative; top: 2px">Sensor 3</li>
              <li><input id="S3_checkbox" type="checkbox" style="position: relative; top: 2px">Sensor 4</li>
              <li><input id="S4_checkbox" type="checkbox" style="position: relative; top: 2px">Sensor 5</li>
              <li><input id="S5_checkbox" type="checkbox" style="position: relative; top: 2px">Sensor 6</li>
              <li><input id="S6_checkbox" type="checkbox" style="position: relative; top: 2px">Sensor 7</li>
              <li><input id="S7_checkbox" type="checkbox" style="position: relative; top: 2px">Sensor 8</li>
              <li><input id="S8_checkbox" type="checkbox" style="position: relative; top: 2px">Sensor 9</li>
            </ul>
          </div>

          <div id="chemicalDropdown" class="dropdown-check-list" style="z-index: 9">
            <span class="anchor" style="padding-right: 28px; margin-top: 5%;">Select Chemicals</span>
            <ul class="items" style="text-align: left">
              <li id="C0_text"><input id="C0_checkbox" type="checkbox" style="position: relative; top: 2px">AGOC-3A</li>
              <li id="C1_text"><input id="C1_checkbox" type="checkbox" style="position: relative; top: 2px">Appluimonia</li>
              <li id="C2_text"><input id="C2_checkbox" type="checkbox" style="position: relative; top: 2px">Chlorodinine</li>
              <li id="C3_text"><input id="C3_checkbox" type="checkbox" style="position: relative; top: 2px">Methylosmolene</li>
            </ul>
          </div>

          <div id="monthDropdown" class="dropdown-check-list" style="margin-top: 5%; z-index: 8">
            <span class="anchor" style="padding-right: 54px;">Select Times</span>
            <ul class="items" style="text-align: left">
              <li style="text-align: center; position: relative; top: -5px;"><u>&nbsp Months &nbsp</u></li>
              <li id="M0_text"><input id="M0_checkbox" type="checkbox" style="position: relative; top: 2px">Apr</li>
              <li id="M1_text"><input id="M1_checkbox" type="checkbox" style="position: relative; top: 2px">Aug</li>
              <li id="M2_text" style="padding-bottom: 12px"><input id="M2_checkbox" type="checkbox" style="position: relative; top: 2px">Dec</li>
              <li style="text-align: center; position: relative; top: -5px;"><u>&nbsp Weeks &nbsp</u></li>
              <li><input id="W0_checkbox" type="checkbox" style="position: relative; top: 2px">W1</li>
              <li><input id="W1_checkbox" type="checkbox" style="position: relative; top: 2px">W2</li>
              <li><input id="W2_checkbox" type="checkbox" style="position: relative; top: 2px">W3 </li>
              <li><input id="W3_checkbox" type="checkbox" style="position: relative; top: 2px">W4</li>
              <li><input id="W4_checkbox" type="checkbox" style="position: relative; top: 2px">W5</li>
            </ul>
          </div>
        </div>
        <button id="RUN" class="button button2" onclick="buttonPressed()" style="position: relative; top: -20px">Run!</button>

        <h4 style="position: relative; top: -30px"><u>&nbsp Toggle Pie Chart &nbsp</u></h4>
        <div style="display: flex; flex-direction: column; position: relative; top: -30px">
          <span class="pie-dropdown">
            Select Sensor
            <select id="sensor-num" onchange="redraw_piechart()" style="left: 7%; position: relative; border: #fff" ></select>
          </span>
        </div>
          

        <h4 style="position: relative; top: -45px"><u>&nbsp Toggle Bar Graph &nbsp</u></h4>
        <div style="display: flex; flex-direction: column; position: relative; top: -45px">
          <select id="chemical-select" class="chem-select" style="left: 10%; position: relative; border: #fff; top: 20px; width: 80%; z-index: 5" onchange="updateBar()"></select>
          <span id="barDropdown" class="bargraph-dropdown" style="padding-bottom: 30px; z-index: 3; top: -25px">
            Select Chemical
          </span>

        </div>

      </div>
      
    </div>
  </div>

<!-- timeline stuff -->
<!-- <span class="pie-dropdown" style="top: -300px">
  Select Sensor
  <select id="sensor-select" style="left: 7%; position: relative; border: #fff" onchange="RenderLineDates(3)"></select>
</span> -->
<span style="position: relative;top: -180px; font-size: 1vw; left: 280px">
  Sensor:
  <select id="sensor-select" style="left: 0%; position: relative; border: #fff; width: 2.5%; height: 15px; z-index: 5" 
    onchange="RenderLineDates(document.getElementById('sensor-select').value)">  
  </select>
</span>
<canvas id="line-chart" style="width:100%;height: 250px; position: relative; top: -204px"></canvas>
<div class="container" style="position: relative; top: -210px;">
  <div class="slider-container">
    <input type="text" id="slider" class="slider"/>
  </div>
</div>

<script src="js/rSlider.min.js"></script>
<script>

  function toggleMap (toggle, name, count) {
    var Toggle = document.getElementById(toggle);
    if (Toggle.checked == true) {
      for (var i = 0; i <= count; i++) {
        document.getElementById(`${name}${i}`).style.visibility = 'visible'
      }
    }
    else{
      for (var i = 0; i <= count; i++) {
        document.getElementById(`${name}${i}`).style.visibility = 'hidden'
      }
    }
  }

  $(".scroll").click(function() {
    $('html,body').animate({
        scrollTop: $("#Yaxis").offset().top + 10},
        1200);
  });


  var chemList = document.getElementById('chemicalDropdown');
  chemList.getElementsByClassName('anchor')[0].onclick = function(evt) {
    if (chemList.classList.contains('visible'))
      chemList.classList.remove('visible');
    else
      chemList.classList.add('visible');
  }

  var monthList = document.getElementById('monthDropdown');
  monthList.getElementsByClassName('anchor')[0].onclick = function(evt) {
    if (monthList.classList.contains('visible'))
      monthList.classList.remove('visible');
    else
      monthList.classList.add('visible');
  }

  var sensorList = document.getElementById('sensorDropdown');
  sensorList.getElementsByClassName('anchor')[0].onclick = function(evt) {
    if (sensorList.classList.contains('visible'))
      sensorList.classList.remove('visible');
    else
      sensorList.classList.add('visible');
  }

  /* Given a month & week (Ex. Apr, Aug, Dec, and 0 = W1, 1 = W2, etc..), returns an
   * array where the first value is average wind direction and the second 
   * average is wind speed
   */ 
  function PasrsingMeteorData(month, week) {
    var found = 0; 
    if (month == 0) {
      month = "Apr";
    }
    else if (month == 1) {
      month = "Aug";
    }
    else if (month == 2) {
      month = "Dec";
    }
    // var WindDirection = 0; 
    // var WindSpeed = 0; 
    var windDirection_windSpeed = new Array(2).fill(0);

    for (const key in METEOR_DATA) {
      var date = new Date(METEOR_DATA[key]["Date"]);
      var dateString = date.toUTCString();

      if (dateString.indexOf(month) > 0) {
        if (date.getUTCDate() <= 7 && week == 0) {
          found += 1; 
          windDirection_windSpeed[0] += METEOR_DATA[key]["Wind Direction"];
          windDirection_windSpeed[1] += METEOR_DATA[key]["Wind Speed (m\/s)"];
        }
        else if (date.getUTCDate() >= 8 && date.getUTCDate() <= 14 && week == 1) {
          found += 1; 
          windDirection_windSpeed[0] += METEOR_DATA[key]["Wind Direction"];
          windDirection_windSpeed[1] += METEOR_DATA[key]["Wind Speed (m\/s)"];
        }
        else if (date.getUTCDate() >= 15 && date.getUTCDate() <= 21 && week == 2) {
          found += 1; 
          windDirection_windSpeed[0] += METEOR_DATA[key]["Wind Direction"];
          windDirection_windSpeed[1] += METEOR_DATA[key]["Wind Speed (m\/s)"];
        }
        else if (date.getUTCDate() >= 22 && date.getUTCDate() <= 28 && week == 3) {
          found += 1; 
          windDirection_windSpeed[0] += METEOR_DATA[key]["Wind Direction"];
          windDirection_windSpeed[1] += METEOR_DATA[key]["Wind Speed (m\/s)"];
        }
        else if (date.getUTCDate() >= 28 && week == 4) {
          found += 1; 
          windDirection_windSpeed[0] += METEOR_DATA[key]["Wind Direction"];
          windDirection_windSpeed[1] += METEOR_DATA[key]["Wind Speed (m\/s)"];
        }
      }
    }
    windDirection_windSpeed[0] = windDirection_windSpeed[0]/found;
    windDirection_windSpeed[1] = windDirection_windSpeed[1]/found;
    return windDirection_windSpeed;
  }


  function convert(chem) {
    if (chem == "AGOC-3A"){
      return 0; 
    }
    else if (chem == "Appluimonia") {
      return 1;
    }
    else if (chem == "Chlorodinine") {
      return 2;
    }
    else if (chem == "Methylosmolene") {
      return 3;
    }
  }
    /* Given a chemical, time (Ex. Apr, Aug, Dec, and W1, W2, etc..), and sensor, returns the
   * average sensor reading of the specified criteria
   */  
  function sensor_data_by_chem_time_sensor(sensor_arr, chem_arr, month_arr, week_arr) {
    var readings = 0;
    var matches = 0;

    var dataTable = Array(9).fill(0).map(()=>Array(4).fill(0))
    var matches = Array(9).fill(0).map(()=>Array(4).fill(0)) 
    var tempARR = []

    for (var key in SENSOR_DATA) {
      var date = new Date(SENSOR_DATA[key]["Date"]);
      var dateString = date.toUTCString();


      if (sensor_arr.includes(SENSOR_DATA[key]["Monitor"])) {
        if (chem_arr.includes(SENSOR_DATA[key]["Chemical"])) {
          for (let i = 0; i < 3; i++) { // itterate over months to check the UTC string
            if (dateString.indexOf(month_arr[i]) > 0) {
              if (date.getUTCDate() <= 7 && week_arr.includes(0)) {
                matches[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += 1; 
                dataTable[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += SENSOR_DATA[key]["Reading"];
              }
              else if (date.getUTCDate() >= 8 && date.getUTCDate() <= 14 && week_arr.includes(1)) {
                matches[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += 1; 
                dataTable[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += SENSOR_DATA[key]["Reading"];
              }
              else if (date.getUTCDate() >= 15 && date.getUTCDate() <= 21 && week_arr.includes(2)) {
                matches[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += 1; 
                dataTable[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += SENSOR_DATA[key]["Reading"];
              }
              else if (date.getUTCDate() >= 22 && date.getUTCDate() <= 28 && week_arr.includes(3)) {
                matches[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += 1; 
                dataTable[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += SENSOR_DATA[key]["Reading"];
              }
              else if (date.getUTCDate() >= 28 && week_arr.includes(4)) {
                matches[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += 1; 
                dataTable[SENSOR_DATA[key]["Monitor"] - 1][convert(SENSOR_DATA[key]["Chemical"])] += SENSOR_DATA[key]["Reading"];
              }

            }
          }
        }
      }
    } 

    for (let i = 0; i < 9; i++) {
      for (let j = 0; j < 4; j++) {
        tempARR.push(dataTable[i][j]/matches[i][j]);
        dataTable[i][j] = dataTable[i][j]/matches[i][j];
      }
    }
    // console.log(dataTable);
    // console.log(tempARR);
    return dataTable;
  }



  function buttonPressed() {
    var WindDirections = [];
    var WindSpeeds = [];

    var sensor_checks = Array(9).fill(-1);
    var chem_checks = Array(4).fill(-1);
    var month_checks = Array(3).fill(-1);
    var week_checks = Array(5).fill(-1);

    WindDirections._PushAndRejectDuplicate = function(el) {
      if (this.indexOf(el) == -1) this.push(el)
      else return;
    }
    WindSpeeds._PushAndRejectDuplicate = function(el) {
      if (this.indexOf(el) == -1) this.push(el)
      else return;
    } 
    
    for (let sensor = 0; sensor < 9; sensor++) {
      for (let chemical = 0; chemical < 4; chemical++) {
        for (let month = 0; month < 3; month++) {
          for (let week = 0; week < 5; week++) {
            if (document.getElementById(`S${sensor}_checkbox`).checked && document.getElementById(`C${chemical}_checkbox`).checked
              && document.getElementById(`M${month}_checkbox`).checked && document.getElementById(`W${week}_checkbox`).checked) {
              
              let temp = PasrsingMeteorData(month, week);
              WindDirections._PushAndRejectDuplicate(temp[0]);
              WindSpeeds._PushAndRejectDuplicate(temp[1]);

              var sumAngle = WindDirections.reduce((a, b) => {return a + b;});
              sumAngle /= WindDirections.length;
              document.getElementById(`TriS${sensor}C${chemical}`).setAttribute("transform", `rotate(${sumAngle - 180},50,50)`);

              sensor_checks[sensor] = sensor+1; 
              chem_checks[chemical] = document.getElementById(`C${chemical}_text`).innerText;
              month_checks[month] = document.getElementById(`M${month}_text`).innerText;;
              week_checks[week] = week;
              // sensorIntensity[sensor][chemical] += sensor_data_by_chem_time_sensor(chemical, month, week, sensor);
              // sensorIntensityCount[sensor][chemical] += 1;
            }
          }
        }
      }
    }
    updated_color(sensor_data_by_chem_time_sensor(sensor_checks, chem_checks, month_checks, week_checks));
  }


  // 3.6520857567415725 max
  // 0.20622352916666664 min 
  // 0.6979370149255458 avg 
  function updated_color(table) { 

    for (let i = 0; i < 9; i++) {
      for (let j = 0; j < 4; j++) {
        if (table[i][j] > 0 && table[i][j] < .21) { // less than min
            if (j == 0) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(113,205,205)"
            }
            else if (j == 1) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,221,137)";
            }
            else if (j == 2) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(100,183,240)";
            }
            else if (j == 3) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,150,172)";
            }
          }
          else if (table[i][j] > .21 && table[i][j] < .50) { // between min and .2 less than avg
            if (j == 0) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(94,199,199)";
            }
            else if (j == 1) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,213,112)";
            }
            else if (j == 2) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(77,173,237)";
            }
            else if (j == 3) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,125,152))";
            }
          }
          else if (table[i][j] > .50 && table[i][j] < .90) { // between .2 less than avg and .2 more than avg
            if (j == 0) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(75,192,192)";
            }
            else if (j == 1) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,206,86)";
            }
            else if (j == 2) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(54,162,235)";
            }
            else if (j == 3) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,99,132)";
            }
          }
          else if (table[i][j] > .90 && table[i][j] < 1.5) {
            if (j == 0) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(63,179,179)";
            }
            else if (j == 1) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,199,61)";
            }
            else if (j == 2) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(31,151,233)";
            }
            else if (j == 3) {
              // console.log(`triFillS${i}C${j}`)
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,74,112)";
            }
          } 
          else if (table[i][j] > 1.5) {
            if (j == 0) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(56,160,160)";
            }
            else if (j == 1) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,191,35)";
            }
            else if (j == 2) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(22,138,216)";
            } 
            else if (j == 3) {
              document.getElementById(`triFillS${i}C${j}`).style.fill = "rgb(255,48,92)";
              // console.log(`triFillS${i}C${j}` + " :" + table[i][j]);
            }
          }
      }
    }
  }

  // Going through all 9 sensors
  for (let i = 0; i < 9; i++) {
    // Bind function to onclick event for checkbox
    document.getElementById(`S${i}_checkbox`).onclick = function() {
      for (let j = 0; j < 4; j++) { // going through all 4 chemicals
        if ( this.checked ) { // access properties using this keyword
          document.getElementById(`S${i}`).style.backgroundColor = "rgba(255,0,106,.9)";
          if (document.getElementById(`C${j}_checkbox`).checked) {
            document.getElementById(`TriS${i}C${j}`).style.display = "block";
          }
          else {
            document.getElementById(`TriS${i}C${j}`).style.display = "none";
          }
        } 
        else {
          document.getElementById(`S${i}`).style.backgroundColor = "rgba(0,0,0,1)";
          document.getElementById(`TriS${i}C${j}`).style.display = "none";
        }
      }
    };
  }
  
  // Going through all 4 chemicals
  for (let i = 0; i < 4; i++) {
    // Bind function to onclick event for checkbox
    document.getElementById(`C${i}_checkbox`).onclick = function() {
        for (let j = 0; j < 9; j++) { // going through all 9 sensors
          if ( this.checked ) { // access properties using this keyword
            if (document.getElementById(`S${j}_checkbox`).checked) {
              document.getElementById(`TriS${j}C${i}`).style.display = "block";
              // adjustFillSize(j);
              // buttonPressed();
            }
            else {
              document.getElementById(`TriS${j}C${i}`).style.display = "none";
            }
          } else {
            document.getElementById(`TriS${j}C${i}`).style.display = "none";
          }
        }
    };
  }

  setInterval(function(){ 
    for (let i = 0; i < 9; i++) {
      adjustFillSize(i);
    }
  }, 200);

  function adjustFillSize(sensor) {
    // All four chemicals are on
    if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && document.getElementById(`TriS${sensor}C1`).style.display == "block"
      && document.getElementById(`TriS${sensor}C2`).style.display == "block"
      && document.getElementById(`TriS${sensor}C3`).style.display == "block") {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 10 0, 30 0');
      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 50 0, 70 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 70 0, 90 0');
    }


    // just the first chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 40 0, 60 0');
    }
    // just the first & second chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the first & third chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the first & fourth chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the first & second & third chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 60 0, 80 0');
    }
    // just the first & second & fourth chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 60 0, 80 0');
    }
    // just the first & third & fourth chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 60 0, 80 0');
    }


    // just the seond chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 40 0, 60 0');
    }
    // just the seond & first chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the second & third chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the second & fourth chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the second & first & third chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 60 0, 80 0');
    }
    // just the second & first & fourth chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 60 0, 80 0');
    }
    // just the second & third & fourth chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 60 0, 80 0');
    }

    // just the third chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 40 0, 60 0');
    }
    // just the third & first chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the third & second chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the third & fourth chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the third & first & second chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display != "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 60 0, 80 0');
    }
    // just the third & second & fourth chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 60 0, 80 0');
    }
    // just the third & first & fourth chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 60 0, 80 0');
    }

    // just the fourth chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 40 0, 60 0');
    }
    // just the fourth & first chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the fourth & second chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the fourth & third chemical
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 30 0, 50 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 50 0, 70 0');
    }
    // just the fourth & first & second chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 60 0, 80 0');
    }
    // just the fourth & second & third chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display != "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C1`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 60 0, 80 0');
    }
    // just the fourth & first & third chemical 
    else if (document.getElementById(`TriS${sensor}C0`).style.display == "block"
      && (document.getElementById(`TriS${sensor}C1`).style.display != "block")
      && (document.getElementById(`TriS${sensor}C2`).style.display == "block")
      && (document.getElementById(`TriS${sensor}C3`).style.display == "block")) {

      document.getElementById(`triFillS${sensor}C0`).setAttribute('points', '50 50, 20 0, 40 0');
      document.getElementById(`triFillS${sensor}C2`).setAttribute('points', '50 50, 40 0, 60 0');
      document.getElementById(`triFillS${sensor}C3`).setAttribute('points', '50 50, 60 0, 80 0');
    }
  }

  // Show the pie chart
  var select = document.getElementById("sensor-num");
  var options = SENSORS;
  SENSORS.forEach (sensor => {
    var el = document.createElement("option");
    el.textContent = sensor;
    el.value = sensor;
    select.appendChild(el);
  })
  generate_pie_chart(1);


  var selectChemical = document.getElementById("chemical-select");
  // var options = SENSORS;
  CHEMICALS.forEach (chemical => {
    var el = document.createElement("option");
    el.textContent = chemical;
    el.value = chemical;
    selectChemical.appendChild(el);
  })

  var selectSensor = document.getElementById("sensor-select");
  SENSORS.forEach (sensor => {
    var el = document.createElement("option");
    el.textContent = sensor;
    el.value = sensor;
    selectSensor.appendChild(el);
  })



// console.log(RenderBarGraph("AGOC-3A", [0, 1, 2]))
var BARGRAPH;

var xValues = ["S1", "S2", "S3", "S4", "S5", "S6", "S7", "S8", "S9"];
var yValues = [10, 10, 10, 10, 10, 10, 10, 10, 10]; // data
var barColors = "rgb(75,192,192)";

// This is the function that gets called when someone toggles the
// chemical. It simply grabs the start and end dates from the sliders
// and sends it off to the updateBarGraph function.
// NOTE(jhuang09): There's probably a better name and/or better way to do
// this and/or updateBarGraph may need a name change. Too tired to do so rn :')
function updateBar() {
  var re = new RegExp('(.+) ,(.+)');
  var vals = slider.getValue();
  var matches = vals.match(re);
  var start_str = matches[1].concat(" 2016")
  var end_str = matches[2].concat(" 2016")
  var start = new Date(start_str)
  var end   = new Date(end_str) 
  updateBarGraph(start, end);
}

function updateBarGraph(start, end) {
  var chemical = document.getElementById("chemical-select").value;
  RenderBarGraph(chemical, start, end);
  // BARGRAPH.data.datasets[0].backgroundColor = 'rgb(255,255,255)';
  // BARGRAPH.update();
}


BARGRAPH = new Chart("BarGraph", {
  type: "bar",
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      data: yValues
    }]
  },
  options: {
    legend: {
      display: false,
      // labels: {
      //   fontColor: 'orange'
      // }
    },
    title: {
      display: true,
      // text: "World Wine Production 2018"
    }
  }
});
Chart.defaults.global.defaultFontColor='#fff';

// Given a date and a number, it returns the date + days.
function add_days(date, days) {
  date.setDate(date.getDate() + days);
  return date;
}

// takes a chemical and a start and end date, returns an array of avg intensities
function RenderBarGraph(chemical, start, end) {
  var data_BarGraph = Array(9).fill(0);
  var matches = Array(9).fill(0);
  var strict_end = add_days(end, 1);

  // utilize the data filtered by start and end dates
  // to further distinguish the data that matches with
  // the chemical of interest.
  filtered_data.forEach(data => {
    var date = new Date(data["Date"])
    var dateString = date.toUTCString();
    if (data["Chemical"] == chemical) {
      matches[data["Monitor"] - 1] += 1;
      data_BarGraph[data["Monitor"] - 1] += data["Reading"];
    }
  })

/*  for (var key in SENSOR_DATA) {
    var date = new Date(SENSOR_DATA[key]["Date"]);
    var dateString = date.toUTCString();
  
    if (SENSOR_DATA[key]["Chemical"] == chemical) {
      if (date >= start && date < end) {
        matches[SENSOR_DATA[key]["Monitor"] - 1] += 1;
        data_BarGraph[SENSOR_DATA[key]["Monitor"] - 1] += SENSOR_DATA[key]["Reading"];
      } 
    }
  } */
  for (let i = 0; i < 9; i++) {
    data_BarGraph[i] = data_BarGraph[i]/matches[i];
  }
  console.log(matches)


  if (chemical == "AGOC-3A") {
    BARGRAPH.data.datasets[0].backgroundColor = "rgb(75,192,192)";
  }
  else if (chemical == "Appluimonia") {
    BARGRAPH.data.datasets[0].backgroundColor = 'rgb(255,206,86)';
  }
  else if (chemical == "Chlorodinine") {
    BARGRAPH.data.datasets[0].backgroundColor = 'rgb(54,162,235)';
  }
  else if (chemical == "Methylosmolene") {
    BARGRAPH.data.datasets[0].backgroundColor = 'rgb(255,99,132)';
  }
  BARGRAPH.data.datasets[0].data = data_BarGraph; 
  BARGRAPH.update()
  // return data_BarGraph;
}

// Returns the filtered data, given start and end dates.
// The goal here is to run through the entirety of SENSOR_DATA once
// and only return the data that is between the start and end dates
// so that future functions will have a smaller dataset to deal with.
function filter_data(start, end) {
  const data = []
  function add_days(date, days) {
    date.setDate(date.getDate() + days);
    return date;
  }
  var strict_end = add_days(end, 1);
  for (var key in SENSOR_DATA) {
    var curr_sensor = SENSOR_DATA[key]['Monitor'];
    var curr_date   = new Date(SENSOR_DATA[key]['Date']);
    var curr_month  = curr_date.getUTCMonth() + 1;
    var curr_day    = curr_date.getUTCDate();
    if (curr_date >= start && curr_date < strict_end) {
        data.push(SENSOR_DATA[key]);
    }
  }
  return data;
}
// Initialize our filtered data. The start and end dates will be the 
// earliest and latest dates of our dataset, respectively.
var filtered_data = filter_data(new Date(2016, 3, 1), new Date(2016, 11, 31))

// Store the slider as a global variable for other uses such as when we want to
// toggle using the dropdown menus.
var slider;

function stringToDate(Datstring) {
  var re = new RegExp('(.+) ,(.+)');
  var matches = Datstring.match(re);
  var start_str = matches[1].concat(" 2016 00:00:00 GMT");
  var end_str = matches[2].concat(" 2016 00:00:00 GMT");
  var start = new Date(start_str);
  var end = new Date(end_str);
  // console.log(start);
  // console.log(start.getTime())
  // console.log(end);
  // console.log(end.getTime())
  UpdateAll(start.getTime(), end.getTime())
}

function UpdateAll(startTime, endTime) {
  // BarGraph
  var data_BarGraph = Array(9).fill(0);
  var bargraph_matches = Array(9).fill(0);
  var chemicalBarGraph = document.getElementById("chemical-select").value;
  // PieChart
  var sensorPieChart = document.getElementById("sensor-num").value;
  var data_PieChart = Array(4).fill(0);
  var piechart_matches = Array(4).fill(0);
  // startTime = 1480914000000;
  // endTime = 1480914000000;
  for (var key in SENSOR_DATA) {
    var date = new Date(SENSOR_DATA[key]["Date"]);
    // var dateString = date.toUTCString();

    if (date.getTime() >= startTime && date.getTime() < endTime + 86400000) { // Adding 1 day to get times until the previous night
      // bar graph stuff
      if (SENSOR_DATA[key]["Chemical"] == chemicalBarGraph) {
        bargraph_matches[SENSOR_DATA[key]["Monitor"] - 1] += 1;
        data_BarGraph[SENSOR_DATA[key]["Monitor"] - 1] += SENSOR_DATA[key]["Reading"];
      }
      // pie chart stuff
      if (SENSOR_DATA[key]["Monitor"] == sensorPieChart) {
        if (SENSOR_DATA[key]["Chemical"] == "AGOC-3A") {
          piechart_matches[0] += 1;
          data_PieChart[0] += SENSOR_DATA[key]["Reading"];
        }
        else if (SENSOR_DATA[key]["Chemical"] == "Appluimonia") {
          piechart_matches[1] += 1;
          data_PieChart[1] += SENSOR_DATA[key]["Reading"];
        }
        else if (SENSOR_DATA[key]["Chemical"] == "Chlorodinine") {
          piechart_matches[2] += 1;
          data_PieChart[2] += SENSOR_DATA[key]["Reading"];
        }
        else if (SENSOR_DATA[key]["Chemical"] == "Methylosmolene") {
          piechart_matches[3] += 1;
          data_PieChart[3] += SENSOR_DATA[key]["Reading"];
        }
      }
    }
  }
  console.log("bargraph_matches" + " " + bargraph_matches)
  console.log("readings" + " " + data_BarGraph)
  for (let i = 0; i < 9; i++) {
    data_BarGraph[i] = data_BarGraph[i]/bargraph_matches[i];
  }

  for (let i = 0; i < 4; i++) {
    data_PieChart[i] = data_PieChart[i]/piechart_matches[i]
  }
  // get help from Janny to do next part after obtaining info
  pieChart.data.datasets[0].data = data_PieChart;
  pieChart.update();

  if (chemicalBarGraph == "AGOC-3A") {
    BARGRAPH.data.datasets[0].backgroundColor = "rgb(75,192,192)";
  }
  else if (chemicalBarGraph == "Appluimonia") {
    BARGRAPH.data.datasets[0].backgroundColor = 'rgb(255,206,86)';
  }
  else if (chemicalBarGraph == "Chlorodinine") {
    BARGRAPH.data.datasets[0].backgroundColor = 'rgb(54,162,235)';
  }
  else if (chemicalBarGraph == "Methylosmolene") {
    BARGRAPH.data.datasets[0].backgroundColor = 'rgb(255,99,132)';
  }
  BARGRAPH.data.datasets[0].data = data_BarGraph; 
  BARGRAPH.update()
}

// time line stuff
var init = function (dates) {               
  slider = new rSlider({
      target: '#slider',
      values: dates,
      range: true,
      set: [2010, 2013],
      onChange: function (vals) {
<<<<<<< HEAD
        console.log(vals);
        stringToDate(vals);

=======
        // Extract the start and end date strings using a regex.
        var re = new RegExp('(.+) ,(.+)');
        var matches = vals.match(re);
        var start_str = matches[1].concat(" 2016")
        var end_str = matches[2].concat(" 2016")
        var start = new Date(start_str)
        var end   = new Date(end_str)
        console.log(start)

        // Set our filtered_data so that we have a smaller
        // dataset to iterate through as we're updating all
        // graphs within our system. Ideally, the next few
        // function calls will rely on this variable as the
        // source.
        filtered_data = filter_data(start, end) 
  			
        // Redraw map
  			// buttonPressed(start, end);

  			// Redraw bar graph
  			updateBarGraph(start, end); 

  			// Redraw pie chart
        var sensor_pie = document.getElementById("sensor-num").value
  			redraw(start, end, sensor_pie);
        // alternatively...
        // redraw_piechart();
>>>>>>> c9093ff603cff3491b07c5482f4350edbf407641
      }
  });
};        
// init()
var flip = false;
var LINEGRAPH;
// takes a chemical and an array of months, returns an array of avg intensities
function RenderLineDates(sensor) {
  // var data_BarGraph = Array(9).fill(0);
  // var matches = Array(9).fill(0);
  var datesX = [];
  var AGOC_Y = Array(92).fill(0);
  var APP_Y = Array(92).fill(0);
  var CHLORO_Y = Array(92).fill(0);
  var METH_Y = Array(92).fill(0);

  var COUNT_AGOC = Array(92).fill(0);
  var COUNT_APP = Array(92).fill(0);;
  var COUNT_CHLORO = Array(92).fill(0);
  var COUNT_METH = Array(92).fill(0);



  for (var key in SENSOR_DATA) {
    var date = new Date(SENSOR_DATA[key]["Date"]);
    var dateString = date.toUTCString();
    // deleting everything after 2016
    var temp = dateString.split('2016')[0];

    if (!(datesX.includes(temp))) {
      datesX.push(temp); // only unique days (Apr 7, 8, 9, etc.)
    }



    if (SENSOR_DATA[key]["Monitor"] == sensor) {
      if (SENSOR_DATA[key]["Chemical"] == "AGOC-3A") {
        if (dateString.indexOf("Apr") > 0) {
          AGOC_Y[date.getUTCDate() - 1] += SENSOR_DATA[key]["Reading"];
          COUNT_AGOC[date.getUTCDate() - 1] += 1; 
        }
        else if (dateString.indexOf("Aug") > 0) {
          AGOC_Y[date.getUTCDate() - 1 + 30] += SENSOR_DATA[key]["Reading"];
          COUNT_AGOC[date.getUTCDate() - 1 + 30] += 1; 
        }
        else if (dateString.indexOf("Dec") > 0) {
          AGOC_Y[date.getUTCDate() - 1 + 61] += SENSOR_DATA[key]["Reading"];
          COUNT_AGOC[date.getUTCDate() - 1 + 61] += 1; 
        }
      }
      if (SENSOR_DATA[key]["Chemical"] == "Appluimonia") {
        if (dateString.indexOf("Apr") > 0) {
          APP_Y[date.getUTCDate() - 1] += SENSOR_DATA[key]["Reading"];
          COUNT_APP[date.getUTCDate() - 1] += 1; 
        }
        else if (dateString.indexOf("Aug") > 0) {
          APP_Y[date.getUTCDate() - 1 + 30] += SENSOR_DATA[key]["Reading"];
          COUNT_APP[date.getUTCDate() - 1 + 30] += 1; 
        }
        else if (dateString.indexOf("Dec") > 0) {
          APP_Y[date.getUTCDate() - 1 + 61] += SENSOR_DATA[key]["Reading"];
          COUNT_APP[date.getUTCDate() - 1 + 61] += 1; 
        }
      }
      if (SENSOR_DATA[key]["Chemical"] == "Chlorodinine") {
        if (dateString.indexOf("Apr") > 0) {
          CHLORO_Y[date.getUTCDate() - 1] += SENSOR_DATA[key]["Reading"];
          COUNT_CHLORO[date.getUTCDate() - 1] += 1;  
        }
        else if (dateString.indexOf("Aug") > 0) {
          CHLORO_Y[date.getUTCDate() - 1 + 30] += SENSOR_DATA[key]["Reading"];
          COUNT_CHLORO[date.getUTCDate() - 1 + 30] += 1; 
        }
        else if (dateString.indexOf("Dec") > 0) {
          CHLORO_Y[date.getUTCDate() - 1 + 61] += SENSOR_DATA[key]["Reading"];
          COUNT_CHLORO[date.getUTCDate() - 1 + 61] += 1; 
        }
      }
      if (SENSOR_DATA[key]["Chemical"] == "Methylosmolene") {
        if (dateString.indexOf("Apr") > 0) {
          METH_Y[date.getUTCDate() - 1] += SENSOR_DATA[key]["Reading"];
          COUNT_METH[date.getUTCDate() - 1] += 1;  
        }
        else if (dateString.indexOf("Aug") > 0) {
          METH_Y[date.getUTCDate() - 1 + 30] += SENSOR_DATA[key]["Reading"];
          COUNT_METH[date.getUTCDate() - 1 + 30] += 1; 
        }
        else if (dateString.indexOf("Dec") > 0) {
          METH_Y[date.getUTCDate() - 1 + 61] += SENSOR_DATA[key]["Reading"];
          COUNT_METH[date.getUTCDate() - 1 + 61] += 1; 
        }
      }
    }
  }
  
  for (let i = 0; i < 92; i++) {
    AGOC_Y[i] = AGOC_Y[i]/COUNT_AGOC[i];
    APP_Y[i] = APP_Y[i]/COUNT_APP[i];
    CHLORO_Y[i] = CHLORO_Y[i]/COUNT_CHLORO[i];
    METH_Y[i] = METH_Y[i]/COUNT_METH[i];
  }
  if (flip == false) {
    init(datesX);
    flip = true;
  }

  LINEGRAPH.data.labels = datesX;
  LINEGRAPH.data.datasets[0].data = AGOC_Y; 
  LINEGRAPH.data.datasets[1].data = APP_Y; 
  LINEGRAPH.data.datasets[2].data = CHLORO_Y; 
  LINEGRAPH.data.datasets[3].data = METH_Y; 
  LINEGRAPH.update();
}

LINEGRAPH = new Chart(document.getElementById("line-chart"), {
  type: 'line',
  data: {
    labels: [],
    datasets: [{ 
        data: [],
        label: "AGOC-3A",
        borderColor: "rgb(75,192,192)",
        backgroundColor: "rgb(75,192,192)",
        fill: false
      }, { 
        data: [],
        label: "Appluimonia",
        borderColor: "rgb(255,206,86)",
        backgroundColor: "rgb(255,206,86)",
        fill: false
      }, { 
        data: [],
        label: "Chlorodinine",
        borderColor: "rgb(54,162,235)",
        backgroundColor: "rgb(54,162,235)",
        fill: false
      }, { 
        data: [],
        label: "Methylosmolene",
        borderColor: "rgb(255,99,132)",
        backgroundColor: "rgb(255,99,132)",
        fill: false
      }
    ]
  },
  options: {
    title: {
      display: false,
      text: 'Timeline'
    },
    scales: {
      yAxes: [{
        gridLines: {
          color: 'rgba(255, 255, 255, .2)', // makes grid lines from y axis red
          zeroLineColor: '#fff'
        }
      }],
      xAxes: [{
        gridLines: {
          color: 'rgba(255, 255, 255, .2)', // makes grid lines from y axis red
          zeroLineColor: '#fff'
        },
        ticks: {
          fontSize: 10
        }
      }]
    }
  }
});

Chart.defaults.global.defaultFontColor='#fff';
RenderLineDates(1);
</script>

</body>
</html>
